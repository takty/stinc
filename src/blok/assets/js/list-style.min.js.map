{"version":3,"sources":["assets/js/list-style.js"],"names":["wp","i18n","__","compose","createHigherOrderComponent","element","createElement","cloneElement","blocks","registerBlockStyle","el","name","label","isDefault","filter","BlockEdit","props","attributes","setAttributes","prevClassName","className","prevOrdered","ordered","o","ucs","c","split","startsWith","includes","isOrdered","hooks","addFilter","blockType","window"],"mappings":"AASA,CAAEA,IACD,MACCC,MAASC,GAAEA,GACXC,SAASC,2BAAEA,GACXC,SAASC,cAAEA,EAAFC,aAAiBA,GAC1BC,QAASC,mBAAEA,IACRT,EACEU,EAAKJ,EAMXG,EAAmB,YAAa,CAC/BE,KAAW,UACXC,MAAWV,EAAG,UAAW,SACzBW,WAAW,IAEZJ,EAAmB,YAAa,CAC/BE,KAAO,SACPC,MAAOV,EAAG,SAAU,WAErBO,EAAmB,YAAa,CAC/BE,KAAO,SACPC,MAAOV,EAAG,SAAU,WAGrBO,EAAmB,YAAa,CAC/BE,KAAO,cACPC,MAAOV,EAAG,cAAe,WAE1BO,EAAmB,YAAa,CAC/BE,KAAO,cACPC,MAAOV,EAAG,cAAe,WAE1BO,EAAmB,YAAa,CAC/BE,KAAO,cACPC,MAAOV,EAAG,cAAe,WAE1BO,EAAmB,YAAa,CAC/BE,KAAO,cACPC,MAAOV,EAAG,cAAe,WAE1BO,EAAmB,YAAa,CAC/BE,KAAO,cACPC,MAAOV,EAAG,cAAe,WAoB1B,MAAMY,EAASV,GAA2BW,GAClCC,IACN,GAAI,cAAgBA,EAAML,KACzB,OAAOD,EAAGK,EAAWC,GAEtB,MAAMC,WAAEA,EAAFC,cAAcA,GAAkBF,EAStC,GAPM,kBAAmBC,IACxBA,EAAWE,cAAgBF,EAAWG,WAEjC,gBAAiBH,IACtBA,EAAWI,YAAcJ,EAAWK,SAGjCL,EAAWI,cAAgBJ,EAAWK,QASzC,OARAJ,EAAc,CAAEG,YAAaJ,EAAWK,UAEX,qBAAzBL,EAAWG,WACdF,EAAc,CACbC,cAAe,mBACfC,UAAe,qBAGVV,EAAGK,EAAWC,GAGtBE,EAAc,CAAEC,cAAeF,EAAWG,YAE1C,MAAMG,EA7CR,SAAmBH,GAClB,MAAMI,EAAM,CAAC,kBAAmB,mBAEhC,IAAK,MAAMC,KAAKL,EAAUM,MAAM,KAC/B,GAAID,EAAEE,WAAW,aAChB,MAAU,qBAANF,EAAiC,MACjCD,EAAII,SAASH,GAInB,OAAO,KAmCII,CAAUZ,EAAWG,WAAa,IAO5C,OANU,OAANG,GACHL,EAAc,CACbG,YAAaE,EACbD,QAAaC,IAGRb,EAAGK,EAAWC,KAEpB,aAEHhB,EAAG8B,MAAMC,UACR,mBACA,+BACAjB,GAYDd,EAAG8B,MAAMC,UACR,wBACA,yCAXqB,CAAC1B,EAAS2B,EAAWf,IACtC,cAAgBe,EAAUrB,MACzB,qBAAuBM,EAAWG,UAC9Bb,EAAaF,EAAS,CAAEe,UAAW,OAGrCf,KApHT,CA4HG4B,OAAOjC","file":"assets\\js\\list-style.min.js","sourcesContent":["/**\n * List Style\n *\n * @author Takuto Yanagida\n * @version 2022-03-22\n *\n * Based on https://github.com/WordPress/gutenberg/issues/15160\n */\n\n((wp) => {\n\tconst {\n\t\ti18n   : { __ },\n\t\tcompose: { createHigherOrderComponent },\n\t\telement: { createElement, cloneElement },\n\t\tblocks : { registerBlockStyle },\n\t} = wp;\n\tconst el = createElement;\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tregisterBlockStyle('core/list', {\n\t\tname     : 'default',\n\t\tlabel    : __('Default', 'wpinc'),\n\t\tisDefault: true,\n\t});\n\tregisterBlockStyle('core/list', {\n\t\tname : 'circle',\n\t\tlabel: __('Circle', 'wpinc'),\n\t});\n\tregisterBlockStyle('core/list', {\n\t\tname : 'square',\n\t\tlabel: __('Square', 'wpinc'),\n\t});\n\n\tregisterBlockStyle('core/list', {\n\t\tname : 'lower-alpha',\n\t\tlabel: __('Lower Alpha', 'wpinc'),\n\t});\n\tregisterBlockStyle('core/list', {\n\t\tname : 'lower-greek',\n\t\tlabel: __('Lower Greek', 'wpinc'),\n\t});\n\tregisterBlockStyle('core/list', {\n\t\tname : 'lower-roman',\n\t\tlabel: __('Lower Roman', 'wpinc'),\n\t});\n\tregisterBlockStyle('core/list', {\n\t\tname : 'upper-alpha',\n\t\tlabel: __('Upper Alpha', 'wpinc'),\n\t});\n\tregisterBlockStyle('core/list', {\n\t\tname : 'upper-roman',\n\t\tlabel: __('Upper Roman', 'wpinc'),\n\t});\n\n\tfunction isOrdered(className) {\n\t\tconst ucs = ['is-style-circle', 'is-style-square'];\n\n\t\tfor (const c of className.split(' ')) {\n\t\t\tif (c.startsWith('is-style-')) {\n\t\t\t\tif (c === 'is-style-default') return null;\n\t\t\t\tif (ucs.includes(c)) return false;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\n\t// -------------------------------------------------------------------------\n\n\n\tconst filter = createHigherOrderComponent(BlockEdit => {\n\t\treturn props => {\n\t\t\tif ('core/list' !== props.name) {\n\t\t\t\treturn el(BlockEdit, props);\n\t\t\t}\n\t\t\tconst { attributes, setAttributes } = props;\n\n\t\t\tif (!('prevClassName' in attributes)) {\n\t\t\t\tattributes.prevClassName = attributes.className;\n\t\t\t}\n\t\t\tif (!('prevOrdered' in attributes)) {\n\t\t\t\tattributes.prevOrdered = attributes.ordered;\n\t\t\t}\n\n\t\t\tif (attributes.prevOrdered !== attributes.ordered) {\n\t\t\t\tsetAttributes({ prevOrdered: attributes.ordered });\n\n\t\t\t\tif (attributes.className !== 'is-style-default') {\n\t\t\t\t\tsetAttributes({\n\t\t\t\t\t\tprevClassName: 'is-style-default' ,\n\t\t\t\t\t\tclassName    : 'is-style-default',\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn el(BlockEdit, props);\n\t\t\t}\n\n\t\t\tsetAttributes({ prevClassName: attributes.className });\n\n\t\t\tconst o = isOrdered(attributes.className ?? '');\n\t\t\tif (o !== null) {\n\t\t\t\tsetAttributes({\n\t\t\t\t\tprevOrdered: o,\n\t\t\t\t\tordered    : o,\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn el(BlockEdit, props);\n\t\t};\n\t}, 'withStyle');\n\n\twp.hooks.addFilter(\n\t\t'editor.BlockEdit',\n\t\t'wpinc/blok/list_filter_style',\n\t\tfilter\n\t);\n\n\tconst removeDefault = (element, blockType, attributes) => {\n\t\tif ('core/list' === blockType.name) {\n\t\t\tif ('is-style-default' === attributes.className) {\n\t\t\t\treturn cloneElement(element, { className: null });\n\t\t\t}\n\t\t}\n\t\treturn element;\n\t}\n\n\twp.hooks.addFilter(\n\t\t'blocks.getSaveElement',\n\t\t'wpinc/blok/list_filter_remove_default',\n\t\tremoveDefault\n\t);\n})(window.wp);\n"]}