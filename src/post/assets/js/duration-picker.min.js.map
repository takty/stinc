{"version":3,"sources":["assets/js/duration-picker.js"],"names":["wp","date","dateI18n","data","useSelect","coreData","useEntityProp","plugins","registerPlugin","element","useState","Fragment","createElement","el","components","DateTimePicker","Button","PanelRow","Dropdown","editPost","PluginDocumentSettingPanel","pmk_from","window","wpinc_duration_picker","pmk_to","labels","format","DropdownDatePicker","label","defaultLabel","currentDate","onChange","id","_","uniqueId","htmlFor","position","renderToggle","onToggle","isOpen","type","onClick","ariaExpanded","ariaLive","isLink","renderContent","v","split","render","postType","select","getCurrentPostType","meta","setMeta","updateMeta","key","val","name","title","panel","date_from","default_from","date_to","default_to","icon"],"mappings":"AAOA,CAAEA,IACD,MACCC,MAAYC,SAAEA,GACdC,MAAYC,UAAEA,GACdC,UAAYC,cAAEA,GACdC,SAAYC,eAAEA,GACdC,SAAYC,SAAEA,EAAFC,SAAYA,EAAUC,cAAeC,GACjDC,YAAYC,eAAEA,EAAFC,OAAkBA,EAAlBC,SAA0BA,EAA1BC,SAAoCA,GAChDC,UAAYC,2BAAEA,IACXpB,EAEEqB,EAAWC,QAAQC,uBAAuBF,UAAY,aACtDG,EAAWF,QAAQC,uBAAuBC,QAAY,WAEtDC,EAASH,QAAQC,uBAAuBE,QAAU,CAAA,EAClDC,EAASJ,QAAQC,uBAAuBG,QAAU,QAElDC,EAAqB,EAAGC,QAAOC,eAAcC,cAAaC,WAAUL,aACzE,MAAOM,GAAMtB,GAAS,IAAMuB,EAAEC,SAAS,yCAEvC,OAAOrB,EACNF,EACA,CAAA,EACAE,EAAG,QAAS,CAAEsB,QAASH,GAAMJ,GAC7Bf,EAAGK,EAAU,CACZkB,SAAc,cACdC,aAAc,EAAGC,WAAUC,YAAa1B,EACvCF,EACA,CAAA,EACA,CACCE,EACCG,EACA,CACCgB,KACAQ,KAAc,SACdC,QAAcH,EACdI,aAAcH,EACdI,SAAc,SACdC,QAAc,GAEfd,EAAc5B,EAASwB,EAAQI,GAAeD,KAIjDgB,cAAe,IAAMhC,EACpBE,EACA,CACCe,cACAC,SAAWe,IAAQf,EAASe,EAAIA,EAAEC,MAAM,KAAK,GAAK,KAA/B,MA5BvB,EA6EDvC,EAAe,wBAAyB,CAAEwC,OA1C3B,KACd,MAAMC,EAAkB7C,GAAW8C,GAAWA,EAAO,eAAeC,sBAAsB,KACnFC,EAAMC,GAAW/C,EAAc,WAAY2C,EAAU,QACtDK,EAAkB,CAACC,EAAKC,IAAQH,EAAQ,IAAKD,EAAMG,CAACA,GAAOC,GAAY,OAE7E,OAAO3C,EACNO,EAA4B,CAC3BqC,KAAO,uBACPC,MAAOjC,EAAOkC,OAAS,YAExB9C,EACCI,EACA,CAAA,EACAJ,EACCc,EACA,CACCC,MAAcH,EAAOmC,WAAgB,OACrC/B,aAAcJ,EAAOoC,cAAgB,YACrC/B,YAAcsB,EAAK/B,GACnBU,SAAce,GAAKQ,EAAWjC,EAAUyB,GACxCpB,YAIHb,EACCI,EACA,CAAA,EACAJ,EACCc,EACA,CACCC,MAAcH,EAAOqC,SAAc,KACnCjC,aAAcJ,EAAOsC,YAAc,YACnCjC,YAAcsB,EAAK5B,GACnBO,SAAce,GAAKQ,EAAW9B,EAAQsB,GACtCpB,YA7BJ,EAqCiDsC,KAAM,gBAjGzD,EAAA,CAkGG1C,OAAOtB","file":"assets\\js\\duration-picker.min.js","sourcesContent":["/**\n * Duration Picker Plugin\n *\n * @author Takuto Yanagida\n * @version 2022-02-27\n */\n\n((wp) => {\n\tconst {\n\t\tdate      : { dateI18n },\n\t\tdata      : { useSelect },\n\t\tcoreData  : { useEntityProp },\n\t\tplugins   : { registerPlugin },\n\t\telement   : { useState, Fragment, createElement: el },\n\t\tcomponents: { DateTimePicker, Button, PanelRow, Dropdown },\n\t\teditPost  : { PluginDocumentSettingPanel },\n\t} = wp;\n\n\tconst pmk_from = window?.wpinc_duration_picker?.pmk_from ?? '_date_from';\n\tconst pmk_to   = window?.wpinc_duration_picker?.pmk_to   ?? '_date_to';\n\n\tconst labels = window?.wpinc_duration_picker?.labels ?? {};\n\tconst format = window?.wpinc_duration_picker?.format ?? 'Y-m-d';\n\n\tconst DropdownDatePicker = ({ label, defaultLabel, currentDate, onChange, format }) => {\n\t\tconst [id] = useState(() => _.uniqueId('wpinc-dropdown-date-picker__toggle-'));\n\n\t\treturn el(\n\t\t\tFragment,\n\t\t\t{},\n\t\t\tel('label', { htmlFor: id }, label),\n\t\t\tel(Dropdown, {\n\t\t\t\tposition    : 'bottom left',\n\t\t\t\trenderToggle: ({ onToggle, isOpen }) => el(\n\t\t\t\t\tFragment,\n\t\t\t\t\t{},\n\t\t\t\t\t[\n\t\t\t\t\t\tel(\n\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\t\ttype        : 'button',\n\t\t\t\t\t\t\t\tonClick     : onToggle,\n\t\t\t\t\t\t\t\tariaExpanded: isOpen,\n\t\t\t\t\t\t\t\tariaLive    : 'polite',\n\t\t\t\t\t\t\t\tisLink      : true,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcurrentDate ? dateI18n(format, currentDate) : defaultLabel\n\t\t\t\t\t\t),\n\t\t\t\t\t]\n\t\t\t\t),\n\t\t\t\trenderContent: () => el(\n\t\t\t\t\tDateTimePicker,\n\t\t\t\t\t{\n\t\t\t\t\t\tcurrentDate,\n\t\t\t\t\t\tonChange: (v) => { onChange(v ? v.split('T')[0] : null); },\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t})\n\t\t)\n\t}\n\n\tconst render = () => {\n\t\tconst postType        = useSelect((select) => select('core/editor').getCurrentPostType(), []);\n\t\tconst [meta, setMeta] = useEntityProp('postType', postType, 'meta');\n\t\tconst updateMeta      = (key, val) => setMeta({ ...meta, [key]: (val ? val : null) });\n\n\t\treturn el(\n\t\t\tPluginDocumentSettingPanel, {\n\t\t\t\tname : 'wpinc-duration-panel',\n\t\t\t\ttitle: labels.panel ?? 'Duration',\n\t\t\t},\n\t\t\tel(\n\t\t\t\tPanelRow,\n\t\t\t\t{},\n\t\t\t\tel(\n\t\t\t\t\tDropdownDatePicker,\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel       : labels.date_from    ?? 'From',\n\t\t\t\t\t\tdefaultLabel: labels.default_from ?? 'Pick Date',\n\t\t\t\t\t\tcurrentDate : meta[pmk_from],\n\t\t\t\t\t\tonChange    : v => updateMeta(pmk_from, v),\n\t\t\t\t\t\tformat,\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t),\n\t\t\tel(\n\t\t\t\tPanelRow,\n\t\t\t\t{},\n\t\t\t\tel(\n\t\t\t\t\tDropdownDatePicker,\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel       : labels.date_to    ?? 'To',\n\t\t\t\t\t\tdefaultLabel: labels.default_to ?? 'Pick Date',\n\t\t\t\t\t\tcurrentDate : meta[pmk_to],\n\t\t\t\t\t\tonChange    : v => updateMeta(pmk_to, v),\n\t\t\t\t\t\tformat,\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t),\n\n\t\t);\n\t};\n\n\tregisterPlugin('wpinc-duration-picker', { render, icon: 'calendar-alt' });\n})(window.wp);\n"]}